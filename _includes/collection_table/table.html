<div class="collection-table-wrapper" tabindex="0" role="region" aria-label="Collection table" data-wheel-mode="smart" data-collection="{{ include.collection }}">
<table>
  <tr>
    {% if include.collection != "aotd" %}
    <th class="sortable dual-sort" data-column="0" data-column-name="App. URL" tabindex="0" role="button" aria-sort="none">App. URL <span class="sort-indicator" aria-hidden="true"></span><br><small class="sort-mode-indicator"></small></th>
    <th class="sortable" data-column="1" data-column-name="Author(s)" tabindex="0" role="button" aria-sort="none">Author(s) <span class="sort-indicator" aria-hidden="true"></span></th>
    <th>Reference(s)</th>
    <th class="sortable" data-column="3" data-column-name="Technology(ies)" tabindex="0" role="button" aria-sort="none">Technology(ies) <span class="sort-indicator" aria-hidden="true"></span></th>
    <th class="sortable dual-sort" data-column="4" data-column-name="Note(s)" tabindex="0" role="button" aria-sort="none">Note(s) <span class="sort-indicator" aria-hidden="true"></span><br><small class="sort-mode-indicator"></small></th>
    {% else %}
    <th>App. URL</th>
    <th>Author(s)</th>
    <th>Reference(s)</th>
    <th>Technology(ies)</th>
    <th>Note(s)</th>
    {% endif %}
  </tr>
  {% for app in include.apps %}
  {% assign tech_values = "" | split: "," %}
  {% assign tech_seen = "" | split: "," %}
  {% if app.technology %}
    {% for tech in app.technology %}
      {% capture canonical_tech %}
        {% include collection_table/normalize_value.html value=tech %}
      {% endcapture %}
      {% assign canonical_tech = canonical_tech | strip %}
      {% if canonical_tech != "" %}
        {% assign canonical_tech_lc = canonical_tech | downcase %}
        {% unless tech_seen contains canonical_tech_lc %}
          {% assign tech_seen = tech_seen | push: canonical_tech_lc %}
          {% assign tech_values = tech_values | push: canonical_tech %}
        {% endunless %}
      {% endif %}
    {% endfor %}
  {% endif %}
  {% assign tech_filter_values = tech_values | join: "|" | downcase %}
  {% assign ref_values = "" %}
  {% if app.references %}
    {% assign ref_values = app.references | map: "name" | join: "|" | downcase %}
  {% endif %}
  {% assign year_value = "" %}
  {% if app.last_contributed %}
    {% assign year_value = app.last_contributed | date: "%Y" %}
  {% endif %}
  <tr data-filter-tech="{{ tech_filter_values | escape }}" data-filter-refs="{{ ref_values | escape }}" data-filter-stars="{{ app.stars | default: 0 }}" data-filter-year="{{ year_value }}">
    <td data-sort-value-text="{{ app.name | default: '' }}" data-sort-value-numeric="{{ app.stars | default: 0 }}">
        <a href="{{ app.url }}">{{ app.name }}</a>
        {% if app.stars %}
            <br><small><span class="star-icon" aria-hidden="true">&#9733;</span> {{ app.stars | number_with_delimiter }}</small>
        {% endif %}
    </td>
    <td>
        {{ app.author }}
    </td>
    <td>
      {% if app.references %}
        <ul>
          {% for ref in app.references %}
            <li><a href="{{ ref.url }}">{{ ref.name | capitalize }}</a></li>
          {% endfor %}
        </ul>
      {% endif %}
    </td>
    <td>
      {% if tech_values.size > 0 %}
        <ul>
          {%- for tech in tech_values -%}
            <li>{{ tech }}</li>
          {%- endfor -%}
        </ul>
      {% endif %}
    </td>
    <td data-sort-value-text="{{ app.notes | default: '' }}" data-sort-value-date="{{ app.last_contributed | default: '' }}">
        {% if app.notes %}
            {{ app.notes }}<br>
        {% endif %}
        {% if app.last_contributed %}
            <small class="not-displayed">Last commit: {{ app.last_contributed | date: "%Y-%m-%d" }}</small>
        {% endif %}
        {% if app.badge %}
             <img alt="GitHub last commit" src="https://img.shields.io/github/last-commit/{{ app.badge }}">
        {% endif %}
    </td>
  </tr>
  {% endfor %}
</table>
</div>
